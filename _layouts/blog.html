<!DOCTYPE html>
<html lang="{{ site.lang | default: "en-US" }}">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{{ page.title }}</title>

    <!-- Open Graph & Twitter Card Tags -->
    <meta property="og:title" content="{{ page.title | default: site.title }}">
    <meta property="og:description" content="{{ page.excerpt | default: site.description | strip_html | normalize_whitespace }}">
    {% if page.anteprima %}
    <meta property="og:image" content="{{ page.anteprima | absolute_url }}">
    <meta name="twitter:image" content="{{ page.anteprima | absolute_url }}">
    {% else %}
    <meta property="og:image" content="{{ '/blog/img/og_share.png' | absolute_url }}">
    <meta name="twitter:image" content="{{ '/blog/img/og_share.png' | absolute_url }}">
    {% endif %}
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:url" content="{{ page.url | absolute_url }}">
    {% if page.layout == 'post' or page.url == '/blog/info/' %}
    <meta property="og:type" content="article">
    {% else %}
    <meta property="og:type" content="website">
    {% endif %}
    <meta name="twitter:card" content="summary">
    <link rel="stylesheet" href="{{ '/assets/css/blog.css' | relative_url }}">
    <link rel="stylesheet" href="{{ '/assets/css/syntax.css' | relative_url }}">

    <link rel="apple-touch-icon" sizes="57x57" href="{{ '/assets/img/favicon/apple-icon-57x57.png' | relative_url }}">
    <link rel="apple-touch-icon" sizes="60x60" href="{{ '/assets/img/favicon/apple-icon-60x60.png' | relative_url }}">
    <link rel="apple-touch-icon" sizes="72x72" href="{{ '/assets/img/favicon/apple-icon-72x72.png' | relative_url }}">
    <link rel="apple-touch-icon" sizes="76x76" href="{{ '/assets/img/favicon/apple-icon-76x76.png' | relative_url }}">
    <link rel="apple-touch-icon" sizes="114x114" href="{{ '/assets/img/favicon/apple-icon-114x114.png' | relative_url }}">
    <link rel="apple-touch-icon" sizes="120x120" href="{{ '/assets/img/favicon/apple-icon-120x120.png' | relative_url }}">
    <link rel="apple-touch-icon" sizes="144x144" href="{{ '/assets/img/favicon/apple-icon-144x144.png' | relative_url }}">
    <link rel="apple-touch-icon" sizes="152x152" href="{{ '/assets/img/favicon/apple-icon-152x152.png' | relative_url }}">
    <link rel="apple-touch-icon" sizes="180x180" href="{{ '/assets/img/favicon/apple-icon-180x180.png' | relative_url }}">
    <link rel="icon" type="image/png" sizes="192x192"  href="{{ '/assets/img/favicon/android-icon-192x192.png' | relative_url }}">
    <link rel="icon" type="image/png" sizes="32x32" href="{{ '/assets/img/favicon/favicon-32x32.png' | relative_url }}">
    <link rel="icon" type="image/png" sizes="96x96" href="{{ '/assets/img/favicon/favicon-96x96.png' | relative_url }}">
    <link rel="icon" type="image/png" sizes="16x16" href="{{ '/assets/img/favicon/favicon-16x16.png' | relative_url }}">
    <link rel="manifest" href="{{ '/assets/img/favicon/manifest.json' | relative_url }}">
</head>
<body>
    <header style="background:var(--blur-bg);backdrop-filter:saturate(180%) blur(20px);border-bottom:1px solid var(--border);position:sticky;top:0;z-index:100">
        <div class="container">
            <nav style="display:flex;justify-content:space-between;align-items:center;padding:16px 0">
                {% if page.layout == 'post' or page.url == '/blog/info/' %}
                  <a style="font-family:'SF Pro Display', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;font-size:20px;font-weight:600;color:var(--text-primary);text-decoration:none;letter-spacing:-0.01em" href="{{ '/blog' | relative_url }}">Indietro</a>
                {% else %}
                  <a style="font-family:'SF Pro Display', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;font-size:20px;font-weight:600;color:var(--text-primary);text-decoration:none;letter-spacing:-0.01em" href="{{ '/blog/info' | relative_url }}">Info</a>
                {% endif %}
                <ul style="display:flex;list-style:none;gap:32px;margin:0;padding:0" class="nav-links">
                    <li><a style="text-decoration:none;color:var(--text-secondary);font-weight:400;font-size:16px;transition:color 0.2s ease" href="{{ '/' | relative_url }}">Portfolio</a></li>
                    <li><a style="text-decoration:none;color:var(--text-secondary);font-weight:400;font-size:16px;transition:color 0.2s ease" href="https://panuozzo77.github.io/LiteraryLog/">LiteraryLog</a></li>
                    <!-- <li><a style="text-decoration:none;color:var(--text-secondary);font-weight:400;font-size:16px;transition:color 0.2s ease" href="{{ '/blog' | relative_url }}">Posts</a></li> -->
                    <li><a style="text-decoration:none;color:var(--text-secondary);font-weight:400;font-size:16px;transition:color 0.2s ease" href="{{ '/feed' | relative_url }}">Feed</a></li>
                </ul>
            </nav>
        </div>
    </header>
    <main style="min-height:calc(100vh - 80px);padding:48px 0">
        <div class="container">
            {{ content }}
        </div>
    </main>
    <footer style="border-top:1px solid var(--border);text-align:center;padding:48px 0;margin-top:80px">
        <div class="container">
            <p style="color:var(--text-tertiary);font-size:14px;margin:0">Â© {{ "now" | date: "%Y" }} {{ site.title }}.</p>
        </div>
    </footer>
</body>
</html>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const searchInput = document.getElementById('search-input');
    const postsContainer = document.getElementById('posts-container');
    const paginationContainer = document.querySelector('.pagination');
    let allPosts = [];
    let initialPostsHTML = postsContainer.innerHTML;

    // Fetch all posts from search.json
    fetch('{{ "/blog/search.json" | relative_url }}')
      .then(response => response.json())
      .then(data => {
        allPosts = data;
      });

    searchInput.addEventListener('input', function (e) {
      const searchTerm = e.target.value.toLowerCase();

      if (searchTerm.length > 0) {
        // Filter posts
        const filteredPosts = allPosts.filter(post => {
          return (
            post.title.toLowerCase().includes(searchTerm) ||
            post.excerpt.toLowerCase().includes(searchTerm) ||
            post.tags.toLowerCase().includes(searchTerm)
          );
        });

        // Display filtered posts
        displayPosts(filteredPosts);
        if (paginationContainer) paginationContainer.style.display = 'none';
      } else {
        // If search is cleared, show paginated posts
        postsContainer.innerHTML = initialPostsHTML;
        if (paginationContainer) paginationContainer.style.display = 'flex';
      }
    });

    function displayPosts(posts) {
      postsContainer.innerHTML = '';
      if (posts.length > 0) {
        posts.forEach(post => {
          const postTags = post.tags ? post.tags.split(',').map(tag => `<span class="tag">${tag.trim()}</span>`).join('') : '';
          const postElement = `
            <article class="card">
              <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:16px">
                <h2 style="margin:0;font-size:28px;word-wrap:break-word;hyphens:auto;line-height:1.3">
                  <a style="color:var(--text-primary)" href="${post.url}">${post.title}</a>
                </h2>
              </div>
              <p style="margin-bottom:16px;font-size:16px">${post.excerpt}</p>
              <div style="margin-bottom:16px;">${postTags}</div>
              <a class="btn-primary" href="${post.url}">Leggi</a>
            </article>
          `;
          postsContainer.innerHTML += postElement;
        });
      } else {
        postsContainer.innerHTML = '<p>Nessun post trovato.</p>';
      }
    }
  });
</script>